<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chart Debug Test</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #1e1e2e;
            color: white;
            padding: 20px;
        }
        .chart-container {
            background: #2a2d47;
            margin: 20px 0;
            padding: 20px;
            border-radius: 10px;
        }
    </style>
</head>
<body>
    <h1>Chart Debug Test</h1>

    <div class="chart-container">
        <h2>Test Simple Chart</h2>
        <div id="testChart" style="height: 400px;"></div>
    </div>

    <div class="chart-container">
        <h2>Test Weekly Response Chart</h2>
        <div id="weeklyResponseChart" style="height: 400px;"></div>
    </div>

    <div class="chart-container">
        <h2>Test Pipeline Distribution Chart</h2>
        <div id="pipelineDistributionChart" style="height: 400px;"></div>
    </div>

    <script>
        console.log('Starting chart debug...');

        // Test 1: Simple chart
        try {
            Plotly.newPlot('testChart', [{
                x: ['A', 'B', 'C'],
                y: [1, 2, 3],
                type: 'bar'
            }], {
                title: 'Simple Test Chart',
                plot_bgcolor: 'rgba(0,0,0,0)',
                paper_bgcolor: 'rgba(0,0,0,0)',
                font: { color: '#e0e0e0' }
            });
            console.log('✅ Simple chart created');
        } catch (e) {
            console.error('❌ Simple chart error:', e);
        }

        // Test 2: Weekly response chart with real data
        try {
            const weeks = ['2025-07-01', '2025-07-08', '2025-07-15'];
            const agentColors = {'Nova': '#4ecdc4', 'Girly': '#ff6b6b'};

            const responseTraces = [];

            // Nova data
            responseTraces.push({
                x: weeks,
                y: [1.57, 3.5, 2.1],
                name: 'Nova',
                type: 'scatter',
                mode: 'lines+markers',
                line: { color: agentColors['Nova'], width: 3 },
                marker: { size: 8, color: agentColors['Nova'] }
            });

            // Girly data
            responseTraces.push({
                x: weeks,
                y: [4.03, 0.87, 1.2],
                name: 'Girly',
                type: 'scatter',
                mode: 'lines+markers',
                line: { color: agentColors['Girly'], width: 3 },
                marker: { size: 8, color: agentColors['Girly'] }
            });

            Plotly.newPlot('weeklyResponseChart', responseTraces, {
                title: {
                    text: 'Weekly Response Times Test',
                    font: { size: 20, color: '#e0e0e0' }
                },
                xaxis: {
                    title: 'Week',
                    color: '#e0e0e0',
                    gridcolor: '#444'
                },
                yaxis: {
                    title: 'Response Time (Hours)',
                    color: '#e0e0e0',
                    gridcolor: '#444'
                },
                plot_bgcolor: 'rgba(0,0,0,0)',
                paper_bgcolor: 'rgba(0,0,0,0)',
                font: { color: '#e0e0e0' },
                legend: { font: { color: '#e0e0e0' } }
            }, {responsive: true});

            console.log('✅ Weekly response chart created');
        } catch (e) {
            console.error('❌ Weekly response chart error:', e);
        }

        // Test 3: Pipeline distribution chart
        try {
            const agents = ['Nova', 'Girly', 'Francis', 'Bhushan'];
            const distributionTraces = [];

            distributionTraces.push({
                x: agents,
                y: [138, 74, 45, 20],
                name: 'Support Pipeline',
                type: 'bar',
                marker: { color: '#4ecdc4' }
            });

            distributionTraces.push({
                x: agents,
                y: [53, 21, 15, 8],
                name: 'Live Chat',
                type: 'bar',
                marker: { color: '#ff6b6b' }
            });

            Plotly.newPlot('pipelineDistributionChart', distributionTraces, {
                title: {
                    text: 'Pipeline Distribution Test',
                    font: { size: 20, color: '#e0e0e0' }
                },
                xaxis: {
                    title: 'Agent',
                    color: '#e0e0e0',
                    gridcolor: '#444'
                },
                yaxis: {
                    title: 'Tickets',
                    color: '#e0e0e0',
                    gridcolor: '#444'
                },
                barmode: 'stack',
                plot_bgcolor: 'rgba(0,0,0,0)',
                paper_bgcolor: 'rgba(0,0,0,0)',
                font: { color: '#e0e0e0' },
                legend: { font: { color: '#e0e0e0' } }
            }, {responsive: true});

            console.log('✅ Pipeline distribution chart created');
        } catch (e) {
            console.error('❌ Pipeline distribution chart error:', e);
        }

        console.log('Chart debug complete. Check console for errors.');
    </script>
</body>
</html>